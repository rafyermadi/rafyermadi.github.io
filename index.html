<!DOCTYPE html>
<html lang="id" data-theme="dark">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Rafy • Blog</title>
  <meta name="description" content="Blog progres menulis & belajar—novel tugas akhir, catatan proses, dan eksperimen tulisan." />
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='50' fill='%239b8cff'/%3E%3C/svg%3E">

  <!-- Fonts untuk “rasa lama” -->
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;800;900&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    /* ============ THEME TOKENS ============ */
    :root{
      --font-display: "Playfair Display", serif;
      --font-sans: "Inter", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;

      --bg-0: #0b0f1a;
      --bg-1: #0f1524;
      --bg-2: #11182a;
      --elev: rgba(255,255,255,0.06);
      --stroke: rgba(255,255,255,0.12);
      --muted: rgba(255,255,255,0.65);
      --text: rgba(255,255,255,0.9);
      --accent: #9b8cff;
      --accent-2: #c7b7ff;
      --chip: rgba(255,255,255,0.08);
      --shadow: 0 12px 32px rgba(0,0,0,.35);
      --shadow-sm: 0 8px 20px rgba(0,0,0,.25);
      --card-bg: linear-gradient(180deg, #111623cc, #0c111acc);
    }
    html[data-theme="light"]{
      --bg-0: #f7f7fb;
      --bg-1: #ffffff;
      --bg-2: #f1f3f9;
      --elev: rgba(0,0,0,0.04);
      --stroke: rgba(0,0,0,0.08);
      --muted: rgba(0,0,0,0.68);
      --text: rgba(0,0,0,0.92);
      --chip: rgba(0,0,0,0.06);
      --shadow: 0 10px 28px rgba(12, 18, 32, .12);
      --shadow-sm: 0 6px 18px rgba(12,18,32,.10);
      --card-bg: linear-gradient(180deg, #ffffffee, #fafbff);
    }

    /* ============ RESET & BASE ============ */
    *{ box-sizing: border-box; }
    html, body{ height: 100%; }
    body{
      margin: 0;
      font-family: var(--font-sans);
      color: var(--text);
      background:
        radial-gradient(1200px 600px at 10% -200px, #1c1f3b 0%, #101629 60%, #0b0f1a 100%),
        linear-gradient(180deg, var(--bg-0), var(--bg-1) 60%, var(--bg-0));
      transition: background .3s ease;
    }
    html[data-theme="light"] body{
      background:
        radial-gradient(1200px 600px at 10% -200px, #e7eaff 0%, #f5f7ff 60%, #ffffff 100%),
        linear-gradient(180deg, #fbfcff, #ffffff 60%, #f7f8ff);
    }

    a{ color: inherit; text-decoration: none; }
    .wrap{ width: min(1200px, 92vw); margin: 0 auto; }

    /* ============ NAVBAR ============ */
    .nav{
      position: sticky; top: 0; z-index: 20;
      background: linear-gradient(180deg, rgba(0,0,0,.35), rgba(0,0,0,0));
      backdrop-filter: blur(6px);
    }
    html[data-theme="light"] .nav{ background: linear-gradient(180deg, rgba(255,255,255,.8), rgba(255,255,255,0)); }
    .nav-inner{
      display:flex; align-items:center; justify-content:space-between;
      padding: 18px 0 8px;
    }
    .brand{
      font-family: var(--font-display); font-weight: 900; letter-spacing:.4px;
      font-size: 22px;
    }
    .nav-right{ display:flex; gap:12px; align-items:center; }
    .pill{
      padding:10px 16px; border-radius: 999px; border:1px solid var(--stroke);
      background: var(--chip); box-shadow: var(--shadow-sm); font-weight:600;
      display:inline-flex; align-items:center; gap:10px;
    }
    .theme{
      width:42px; height:42px; border-radius:14px; border:1px solid var(--stroke);
      display:grid; place-items:center; background: var(--chip); box-shadow: var(--shadow-sm);
      cursor:pointer;
    }

    /* ============ HERO ============ */
    .hero{
      padding: 56px 0 28px;
      background:
        radial-gradient(900px 420px at 12% -120px, rgba(155,140,255,.18) 0%, rgba(155,140,255,0) 60%),
        radial-gradient(900px 420px at 92% -140px, rgba(199,183,255,.12) 0%, rgba(199,183,255,0) 60%);
    }
    .hero-grid{
      display:grid; grid-template-columns: 120px 1fr; gap:28px; align-items:center;
    }
    .avatar{
      width:120px; height:120px; border-radius:50%;
      background: radial-gradient(circle at 35% 30%, #d3c7ff 0%, #9b8cff 55%, #7e6cff 100%);
      box-shadow: 0 8px 24px rgba(0,0,0,.35), 0 0 0 6px rgba(155,140,255,.15) inset;
      display:grid; place-items:center; color:#fff; font-weight:800; line-height:1.1; text-align:center;
      padding:10px;
    }
    .title{
      font-family: var(--font-display); font-weight: 900; letter-spacing:-.02em;
      font-size: clamp(28px, 4vw + 18px, 64px); line-height: 1.05; margin: 0 0 8px;
      text-shadow: 0 2px 0 rgba(0,0,0,.08);
    }
    .sub{ color: var(--muted); font-size: clamp(14px, 1.4vw + 8px, 18px); }
    .meter{
      width: 160px; height: 6px; border-radius: 999px; background: rgba(255,255,255,.1);
      position: relative; overflow: hidden; margin-top: 10px;
    }
    .meter::after{
      content:""; position:absolute; inset:0;
      background: linear-gradient(90deg, var(--accent), var(--accent-2));
      transform: scaleX(.6); transform-origin: left center;
      border-radius:999px;
    }
    .stat{ margin-top:10px; color: var(--muted); font-weight:600; letter-spacing:.2px; }

    /* ============ SEARCH & FILTERS ============ */
    .tools{
      display:flex; gap:12px; align-items:center; margin: 18px 0 28px;
    }
    .search{
      flex:1; height:54px; border-radius:16px; border:1px solid var(--stroke);
      background: var(--elev); box-shadow: var(--shadow-sm);
      display:flex; align-items:center; gap:12px; padding:0 16px; color: var(--muted);
    }
    .search input{
      all:unset; flex:1; color: var(--text); font-size:16px;
    }
    .btn{ cursor:pointer; }
    .tag-wrap{ position: relative; } /* <== supaya dropdown nempel tombol */
    .menu{
      position:absolute; top: calc(100% + 10px); right: 0;
      width: 320px; max-width: calc(100vw - 32px);
      background: var(--card-bg); border:1px solid var(--stroke); border-radius:18px;
      box-shadow: var(--shadow); padding: 14px 14px 10px; display:none;
    }
    .menu.open{ display:block; }
    .menu h5{ margin: 0 0 10px; color: var(--muted); font-size: 12px; letter-spacing:.5px; }
    .menu a{
      display:block; padding: 10px 12px; border-radius: 12px; font-weight:700;
      background: transparent; border:1px solid transparent;
    }
    .menu a:hover{ background: var(--elev); border-color: var(--stroke); }

    /* ============ GRID & CARDS ============ */
    .grid{ display:grid; grid-template-columns: 1.8fr .95fr; gap:18px; align-items:start; }
    @media (max-width: 900px){ .grid{ grid-template-columns: 1fr; } }

    .card{
      background: var(--card-bg);
      border:1px solid var(--stroke);
      border-radius: 22px;
      box-shadow: var(--shadow);
      overflow: hidden;
    }
    .card.pad{ padding: 18px; }
    .post{ padding: 22px 22px 10px; }
    .post h3{ margin: 0 0 8px; font-family: var(--font-display); font-size: 34px; letter-spacing:-.02em; }
    .meta{ color: var(--muted); font-size: 14px; display:flex; gap:10px; align-items:center; }
    .chips{ display:flex; gap:8px; flex-wrap:wrap; margin: 6px 0 12px; }
    .chip{
      display:inline-flex; align-items:center; height: 32px; padding:0 12px;
      background: var(--chip); border:1px solid var(--stroke); border-radius:999px; font-weight:700;
    }
    .thumb{
      height: 180px; border-top:1px solid var(--stroke); background: linear-gradient(135deg, #1b2038, #161c2f);
    }
    html[data-theme="light"] .thumb{ background: linear-gradient(135deg, #e8ebff, #f3f5ff); }
    .excerpt{ color: var(--muted); line-height:1.65; }

    .side h4{ margin:6px 0 12px; font-size:18px; }
    .toc a{ display:block; padding:10px 12px; border-radius:12px; border:1px solid transparent; }
    .toc a:hover{ background: var(--elev); border-color: var(--stroke); }

    /* ============ FOOTER ============ */
    footer{
      margin: 36px 0 56px; color: var(--muted); text-align:center; font-size:14px;
    }
    footer a{ color: var(--accent); font-weight:800; }

    /* ============ LOADER ============ */
    .loader{
      position:fixed; inset:0; z-index:1000; display:none; place-items:center;
      background: radial-gradient(600px 260px at 50% -80px, rgba(155,140,255,.18), transparent 70%), rgba(0,0,0,.45);
      backdrop-filter: blur(4px);
    }
    .loader.show{ display:grid; }
    .spinner{
      width: 72px; height: 72px; border-radius: 50%;
      border: 6px solid rgba(255,255,255,.18);
      border-top-color: var(--accent);
      animation: spin 900ms linear infinite;
      box-shadow: 0 8px 30px rgba(0,0,0,.4), 0 0 0 6px rgba(155,140,255,.18) inset;
    }
    @keyframes spin{ to { transform: rotate(1turn); } }

    /* Small helpers */
    .srch-ico{opacity:.6}
  </style>
</head>
<body>
  <!-- Loader -->
  <div id="loader" class="loader">
    <div class="spinner"></div>
  </div>

  <!-- NAV -->
  <header class="nav">
    <div class="wrap nav-inner">
      <a class="brand" href="#/">Rafy • Blog</a>
      <nav class="nav-right">
        <a class="pill" href="#/">Beranda</a>
        <a class="pill" href="#/blog">Blog</a>
        <a class="pill" href="#/novel">Novel</a>
        <a class="pill" href="#/about">Tentang Penulis</a>
        <button id="themeBtn" class="theme" title="Ganti tema">
          <!-- little emoji disk -->
          <span>🟣</span>
        </button>
      </nav>
    </div>
  </header>

  <!-- HERO -->
  <section class="hero">
    <div class="wrap">
      <div class="hero-grid">
        <div class="avatar">Rafy<br>Rayyan<br>Ermadi</div>
        <div>
          <h1 class="title">Halo, aku Rafy Rayyan Ermadi</h1>
          <p class="sub">Blog progres menulis & belajar—novel tugas akhir, catatan proses, dan eksperimen tulisan.</p>
          <div class="meter"></div>
          <div id="stat" class="stat">0 posting • 0 bab • 0 catatan</div>
        </div>
      </div>
    </div>
  </section>

  <!-- TOOLS -->
  <section class="wrap">
    <div class="tools">
      <label class="search" aria-label="Pencarian">
        <svg class="srch-ico" width="18" height="18" viewBox="0 0 24 24"><path fill="currentColor" d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5m-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5S14 7.01 14 9.5S11.99 14 9.5 14"/></svg>
        <input id="searchInput" type="text" placeholder="Cari judul, tag, atau seri..." />
      </label>
      <button id="sortBtn" class="pill btn">Terbaru</button>
      <div class="tag-wrap">
        <button id="tagBtn" class="pill btn">#Tag ▾</button>
        <div id="tagMenu" class="menu" role="menu" aria-labelledby="tagBtn">
          <h5>FILTER #TAG</h5>
          <a data-tag="bab" href="#"># bab</a>
          <a data-tag="catatan" href="#"># catatan</a>
          <a data-tag="progres" href="#"># progres</a>
          <h5 style="margin-top:12px">LAINNYA</h5>
          <a data-tag="__all" href="#">Tampilkan semua</a>
        </div>
      </div>
    </div>
  </section>

  <!-- CONTENT -->
  <main class="wrap" id="app"></main>

  <!-- FOOTER -->
  <footer class="wrap">
    © 2025 • Made with ❤️ by
    <a href="https://www.instagram.com/rafy.rayyan/" target="_blank" rel="noopener">Rafy Rayyan</a>.
    Hak cipta dilindungi undang-undang. Mohon tidak menyalin atau mendistribusikan ulang tanpa izin.
  </footer>

  <script>
    /* ================== DATA DUMMY ================== */
    const POSTS = [
      {
        id: "bab-1-bayang-kota",
        date: "2025-09-01",
        read: "2 menit baca",
        title: "Bab 1 — Bayang Kota",
        tags: ["bab","progres","novel"],
        excerpt: "Pengenalan tokoh utama dan konflik awal. Lampu-lampu malam mulai hidup; bayangan gedung merayap di aspal basah.",
        body: `
          <p>Ini paragraf pembuka yang menyiapkan suasana kota saat senja. Lampu-lampu mulai hidup, dan bayangan gedung merayap di aspal basah. Tokoh utama berdiri di tepi trotoar, menatap persimpangan yang mengubah nasibnya.</p>
          <p>Di bab ini, konflik awal pelan-pelan muncul. Ada janji yang harus ditepati, ada rahasia yang mulai retak.</p>
        `
      },
      {
        id: "catatan-proses-1",
        date: "2025-08-30",
        read: "1 menit baca",
        title: "Catatan Proses #1 — Kenapa Tema Ini?",
        tags: ["catatan","progres"],
        excerpt: "Menjawab: kenapa pilih tema ini, dan apa riset awalnya.",
        body: `
          <p>Aku milih tema ini karena dekat dengan pengalaman sehari-hari tapi tetap punya ruang fiksi yang luas. Riset awal terutama ngumpulin dokumentasi suasana kota, kebiasaan warga, rute transportasi, dan dengar cerita-cerita kecil.</p>
          <p>Target mingguan: nulis 700–900 kata / bab, dan ngepos progres tiap akhir pekan.</p>
        `
      }
    ];

    /* ================== STATE ================== */
    const state = {
      query: "",
      sortDesc: true,
      tag: "__all" // "__all" | "bab" | "catatan" | "progres"
    };

    /* ================== HELPERS ================== */
    const $ = sel => document.querySelector(sel);
    const $$ = sel => Array.from(document.querySelectorAll(sel));

    function showLoader() { $("#loader").classList.add("show"); }
    function hideLoader() { $("#loader").classList.remove("show"); }

    function formatDate(iso){
      try{
        const d = new Date(iso + 'T00:00:00');
        return d.toLocaleDateString('id-ID', { day:'numeric', month:'short', year:'numeric' }).replace('.', '');
      }catch{ return iso; }
    }

    function computeStats(){
      const total = POSTS.length;
      const bab = POSTS.filter(p=>p.tags.includes("bab")).length;
      const catatan = POSTS.filter(p=>p.tags.includes("catatan")).length;
      $("#stat").textContent = `${total} posting • ${bab} bab • ${catatan} catatan`;
    }

    /* ================== RENDERERS ================== */
    function renderList(list){
      const cards = list.map(p => `
        <article class="card post">
          <div class="meta">
            <span>${formatDate(p.date)}</span>
            <span>•</span>
            <span>${p.read}</span>
          </div>
          <h3><a href="#/post/${p.id}">${p.title}</a></h3>
          <div class="chips">
            ${p.tags.map(t=>`<span class="chip"># ${t}</span>`).join("")}
          </div>
          <div class="thumb"></div>
          <p class="excerpt">${p.excerpt}</p>
        </article>
      `).join("");

      return `
        <section class="grid">
          <div class="stack">
            <div class="card">${cards || `<div class="pad">Tidak ada posting yang cocok.</div>`}</div>
          </div>
          <aside class="side">
            <div class="card pad toc">
              <h4>DAFTAR ISI</h4>
              ${POSTS.filter(p=>p.tags.includes("bab")).map(p=>`<a href="#/post/${p.id}">${p.title}</a>`).join("")}
              <div style="height:8px"></div>
              <h4>Tentang Penulis</h4>
              <a href="#/about">Rafy Rayyan Ermadi</a>
            </div>
          </aside>
        </section>
      `;
    }

    function renderHome(){
      const list = filteredPosts();
      return renderList(list);
    }

    function renderBlog(){
      // tampilkan semua (tetap hormati filter & search)
      return renderList(filteredPosts());
    }

    function renderNovel(){
      // paksa filter tag "bab"
      const prev = state.tag;
      state.tag = "bab";
      const html = renderList(filteredPosts());
      state.tag = prev;
      return html;
    }

    function renderAbout(){
      return `
        <section class="grid">
          <div class="card pad">
            <h3 style="font-family:var(--font-display); font-size:34px; margin:4px 0 8px;">Halo, aku Nama Kamu 👋</h3>
            <p>Aku siswa kelas 12 yang lagi nulis novel untuk tugas akhir Bahasa Indonesia. Di blog ini, aku upload progres, bab, dan catatan proses kreatif.</p>
            <p><strong>Kritik & saran sangat membantu!</strong> Kalau ada masukan soal alur, gaya bahasa, atau ritme, feel free kirim pesan ke Instagram ya.</p>
          </div>
          <aside class="side">
            <div class="card pad">
              <h4>Kontak</h4>
              <p>Instagram: <a style="color:var(--accent); font-weight:800" href="https://www.instagram.com/rafy.rayyan/" target="_blank" rel="noopener">@rafy.rayyan</a></p>
            </div>
          </aside>
        </section>
      `;
    }

    function renderPost(id){
      const p = POSTS.find(x=>x.id===id);
      if(!p) return `<div class="card pad">Posting tidak ditemukan.</div>`;
      return `
        <article class="grid">
          <div class="card pad">
            <div class="meta">
              <span>${formatDate(p.date)}</span>
              <span>•</span>
              <span>${p.read}</span>
            </div>
            <h1 class="title" style="font-size:42px">${p.title}</h1>
            <div class="chips">${p.tags.map(t=>`<span class="chip"># ${t}</span>`).join("")}</div>
            <div class="thumb" style="height:220px; border-radius:16px; margin: 6px 0 16px;"></div>
            <div class="excerpt" style="color:var(--text)">${p.body}</div>
          </div>
          <aside class="side">
            <div class="card pad toc">
              <h4>DAFTAR ISI</h4>
              ${POSTS.filter(x=>x.tags.includes("bab")).map(x=>`<a href="#/post/${x.id}">${x.title}</a>`).join("")}
              <div style="height:8px"></div>
              <h4>Tentang Penulis</h4>
              <a href="#/about">Rafy Rayyan Ermadi</a>
            </div>
          </aside>
        </article>
      `;
    }

    function filteredPosts(){
      let list = [...POSTS];
      // tag
      if(state.tag !== "__all"){
        list = list.filter(p => p.tags.includes(state.tag));
      }
      // search
      const q = state.query.trim().toLowerCase();
      if(q){
        list = list.filter(p =>
          p.title.toLowerCase().includes(q) ||
          p.excerpt.toLowerCase().includes(q) ||
          p.tags.some(t => ("# " + t).includes(q) || t.includes(q))
        );
      }
      // sort
      list.sort((a,b) => (state.sortDesc ? (b.date.localeCompare(a.date)) : (a.date.localeCompare(b.date))));
      return list;
    }

    /* ================== ROUTER ================== */
    function parseRoute(){
      const hash = location.hash || "#/";
      const seg = hash.slice(2).split("/"); // remove "#/"
      // / -> [""] ; /post/xxx -> ["post","xxx"]
      if(seg[0] === "") return {view:"home"};
      if(seg[0] === "blog") return {view:"blog"};
      if(seg[0] === "novel") return {view:"novel"};
      if(seg[0] === "about") return {view:"about"};
      if(seg[0] === "post" && seg[1]) return {view:"post", id: seg[1]};
      return {view:"home"};
    }

    async function showRoute(){
      showLoader();
      await new Promise(r => setTimeout(r, 350)); // beri momen ke loader muncul
      const {view, id} = parseRoute();
      let html = "";
      if(view==="home") html = renderHome();
      else if(view==="blog") html = renderBlog();
      else if(view==="novel") html = renderNovel();
      else if(view==="about") html = renderAbout();
      else if(view==="post") html = renderPost(id);
      $("#app").innerHTML = html;
      computeStats();
      hideLoader();
      closeTagMenu(); // pastikan menu menutup saat berpindah halaman
      // scroll ke atas tiap rute baru
      window.scrollTo({top:0, behavior:"instant"});
    }

    /* ================== THEME ================== */
    function applyStoredTheme(){
      const saved = localStorage.getItem("theme") || "dark";
      document.documentElement.setAttribute("data-theme", saved);
    }
    function toggleTheme(){
      const cur = document.documentElement.getAttribute("data-theme");
      const next = cur==="dark" ? "light" : "dark";
      document.documentElement.setAttribute("data-theme", next);
      localStorage.setItem("theme", next);
    }

    /* ================== UI EVENTS ================== */
    // Search
    $("#searchInput").addEventListener("input", (e)=>{ state.query = e.target.value; showRoute(); });
    // Sort
    $("#sortBtn").addEventListener("click", ()=>{
      state.sortDesc = !state.sortDesc;
      $("#sortBtn").textContent = state.sortDesc ? "Terbaru" : "Terlama";
      showRoute();
    });
    // Tag dropdown
    const tagBtn = $("#tagBtn");
    const tagMenu = $("#tagMenu");
    function closeTagMenu(){ tagMenu.classList.remove("open"); }
    tagBtn.addEventListener("click", (e)=>{
      e.stopPropagation();
      tagMenu.classList.toggle("open");
    });
    tagMenu.addEventListener("click", (e)=>{
      const a = e.target.closest("a[data-tag]");
      if(!a) return;
      e.preventDefault();
      state.tag = a.dataset.tag;
      closeTagMenu();
      showRoute();
      // Update label tombol
      tagBtn.textContent = state.tag==="__all" ? "#Tag ▾" : `#${state.tag} ▾`;
    });
    document.addEventListener("click", (e)=>{
      // tutup kalau klik di luar
      if(!tagMenu.contains(e.target) && !tagBtn.contains(e.target)) closeTagMenu();
    });
    // Tutup saat scroll (tetap ikut posisi tombol karena absolute di wrapper)
    document.addEventListener("scroll", ()=> closeTagMenu(), {passive:true});

    // Theme toggle
    $("#themeBtn").addEventListener("click", toggleTheme);

    // Router hooks
    window.addEventListener("hashchange", showRoute);
    window.addEventListener("load", ()=>{ applyStoredTheme(); showRoute(); });

  </script>
</body>
</html>
