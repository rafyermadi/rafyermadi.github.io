<!doctype html>
<html lang="id" data-theme="dark">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Rafy • Blog</title>

  <!-- 1) Anti FOUC & Theme-First: terapkan tema sebelum CSS diload -->
  <script>
    (function () {
      try {
        const saved = localStorage.getItem("theme") || "dark";
        document.documentElement.setAttribute("data-theme", saved);
      } catch (e) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    })();
  </script>

  <!-- 2) Font -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Playfair+Display:wght@700;800&display=swap" rel="stylesheet">

  <!-- 3) CSS -->
  <style>
    :root{
      --radius:18px;
      --shadow-1: 0 6px 30px rgba(0,0,0,.25);
      --shadow-2: 0 18px 60px rgba(0,0,0,.35);
      --tr-150: 150ms ease;
    }
    :root[data-theme="dark"]{
      color-scheme: dark;
      --bg: #0d1117;
      --bg-soft: #0f1320;
      --surface: #161b22;
      --text: #e6edf3;
      --text-soft:#c6d2de;
      --muted:#8b98a5;
      --primary:#9bbcf9;
      --accent:#c59cff;
      --chip:#202736;
      --chip-text:#d7e2ef;
      --border: #243044;
      --hero-grad-1:#101626;
      --hero-grad-2:#0d1324;
      --hero-ring:#5b76ff33;
    }
    :root[data-theme="light"]{
      color-scheme: light;
      --bg: #f7f8fb;
      --bg-soft: #f1f4fb;
      --surface: #ffffff;
      --text: #0b1523;
      --text-soft:#344055;
      --muted:#5d6a7a;
      --primary:#2b59ff;
      --accent:#6b3cff;
      --chip:#eef2fb;
      --chip-text:#0b1523;
      --border: #dde4f2;
      --hero-grad-1:#eef3ff;
      --hero-grad-2:#fafcff;
      --hero-ring:#2b59ff22;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, "Helvetica Neue", Arial, "Apple Color Emoji","Segoe UI Emoji", "Segoe UI Symbol";
      background: var(--bg);
      color: var(--text);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    a{color:inherit;text-decoration:none}
    .wrap{max-width:1180px;margin:0 auto;padding:0 20px}

    /* Topbar */
    .topbar{
      position:sticky;top:0;z-index:50;
      backdrop-filter:saturate(1.2) blur(10px);
      background: linear-gradient(180deg, rgba(0,0,0,.25), rgba(0,0,0,0)) ;
      border-bottom:1px solid transparent;
    }
    .nav{
      display:flex;align-items:center;gap:14px;justify-content:space-between;
      padding:18px 0;
    }
    .brand{
      font-family:"Playfair Display",serif;
      font-size:26px;font-weight:800;letter-spacing:.2px;
    }
    .tabs{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
    .chip{
      background: var(--chip);color:var(--chip-text);
      padding:10px 16px;border-radius:999px;border:1px solid var(--border);
      box-shadow: 0 1px 0 rgba(255,255,255,.06) inset;
      transition: transform var(--tr-150), background var(--tr-150);
      font-weight:600
    }
    .chip:hover{transform:translateY(-1px)}
    .toggle{
      width:38px;height:38px;border-radius:12px;border:1px solid var(--border);
      display:grid;place-items:center;background:var(--surface);cursor:pointer;
      box-shadow: var(--shadow-1);
    }
    .toggle i{width:18px;height:18px;border-radius:50%;
      background: conic-gradient(from 0deg,#f7c948 0 50%, #6b3cff 0 100%);
      box-shadow:0 0 0 3px var(--hero-ring) inset
    }

    /* Hero */
    .hero{
      position:relative;margin-top:-8px;padding:56px 0 28px;
      background: radial-gradient(1200px 600px at 10% -10%, var(--hero-grad-1), transparent 60%),
                  radial-gradient(900px 500px at 90% -20%, var(--hero-grad-2), transparent 60%);
      border-bottom:1px solid var(--border);
    }
    .hero-inner{display:grid;grid-template-columns:110px 1fr;gap:24px;align-items:center}
    .avatar{
      width:110px;height:110px;border-radius:999px;
      background: radial-gradient(80% 80% at 30% 20%, #e0d3ff, #9ea7ff 70%, #7b59ff);
      border:6px solid var(--bg);
      box-shadow: 0 0 0 8px var(--hero-ring), var(--shadow-2);
    }
    .hero h1{
      margin:0;
      font-family:"Playfair Display",serif;
      font-weight:800;
      letter-spacing:.3px;
      line-height:1.1;
      font-size: clamp(28px, 6vw, 64px);
      text-shadow: 0 1px 0 rgba(0,0,0,.3);
    }
    .hero .desc{margin-top:8px;color:var(--text-soft);font-size:18px}
    .meter{height:6px;width:220px;background:var(--chip);border-radius:999px;margin-top:14px;position:relative;overflow:hidden;border:1px solid var(--border)}
    .meter::after{
      content:"";position:absolute;left:0;top:0;height:100%;width:45%;
      background: linear-gradient(90deg, var(--accent), var(--primary));
      box-shadow: 0 0 18px var(--primary);
    }
    .stats{margin-top:10px;color:var(--muted);font-weight:600}

    /* Search & filters */
    .toolbar{display:flex;gap:12px;align-items:center;margin:18px 0 10px;flex-wrap:wrap}
    .search{
      flex:1;display:flex;align-items:center;gap:10px;
      background: var(--surface); border:1px solid var(--border); border-radius:999px; padding:14px 18px;
      box-shadow: var(--shadow-1);
      color:var(--muted)
    }
    .search input{
      outline:0;border:0;background:transparent;color:var(--text);
      width:100%;font-size:16px
    }

    /* Tag dropdown */
    .tag-wrap{position:relative}
    .menu{
      position:absolute;right:0;top:calc(100% + 10px);min-width:280px;
      background:var(--surface);border:1px solid var(--border);border-radius:16px;
      box-shadow: var(--shadow-2);padding:14px;display:none
    }
    .menu.open{display:block}
    .menu h5{margin:4px 8px 10px;color:var(--muted);letter-spacing:.6px}
    .menu .item{padding:10px 12px;border-radius:12px;cursor:pointer}
    .menu .item:hover{background:var(--chip)}

    /* Grid list & cards */
    .grid{display:grid;grid-template-columns:1fr 360px;gap:18px}
    @media (max-width: 980px){.grid{grid-template-columns:1fr}}
    .card{
      background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);
      box-shadow: var(--shadow-1);padding:22px; overflow:hidden
    }
    .card h3{margin:0 0 6px;font-family:"Playfair Display",serif;font-size: clamp(22px, 3.8vw, 38px)}
    .meta{color:var(--muted);font-size:14px;margin:6px 0 12px;display:flex;gap:14px;align-items:center}
    .tags{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
    .t{font-weight:700; font-size:13px; padding:6px 10px; border-radius:999px; background:var(--chip); color:var(--chip-text); border:1px solid var(--border)}

    /* Sidebar */
    .side .card h4{margin:0 0 10px;font-size:14px;letter-spacing:.8px;color:var(--muted)}
    .toc a{display:block;padding:10px 12px;border-radius:10px}
    .toc a:hover{background:var(--chip)}

    /* Post page */
    .post h1{font-family:"Playfair Display",serif;font-size: clamp(28px,5vw,52px);margin:0 0 10px}
    .post .content{line-height:1.75;color:var(--text-soft);font-size:18px}
    .post .content p{margin:10px 0 18px}
    .post .content img{max-width:100%;border-radius:14px;border:1px solid var(--border)}
    .lead{color:var(--muted);margin-bottom:12px}

    /* Footer */
    footer{padding:28px 0 40px;color:var(--muted);text-align:center}
    footer a{color:var(--primary);font-weight:700}

    /* Loader */
    .loader{
      position:fixed;inset:0;background:rgba(0,0,0,.25);
      display:none;place-items:center;z-index:70;backdrop-filter: blur(4px) saturate(1.2);
    }
    .loader.show{display:grid}
    .spinner{
      width:58px;height:58px;border-radius:50%;
      border:4px solid rgba(255,255,255,.18);
      border-top-color: var(--primary);
      animation: spin 900ms linear infinite;
      box-shadow: 0 0 0 6px var(--hero-ring);
    }
    @keyframes spin{to{transform:rotate(1turn)}}

    /* Page transition */
    .fade{opacity:0; transform:translateY(6px); transition:opacity 180ms ease, transform 180ms ease}
    .fade.in{opacity:1; transform:none}
  </style>
</head>
<body>
  <!-- Loader -->
  <div id="loader" class="loader"><div class="spinner"></div></div>

  <!-- Topbar -->
  <header class="topbar">
    <div class="wrap">
      <div class="nav">
        <div class="brand">Rafy • Blog</div>
        <div class="tabs">
          <a href="#/" class="chip">Beranda</a>
          <a href="#/blog" class="chip">Blog</a>
          <a href="#/novel" class="chip">Novel</a>
          <a href="#/about" class="chip">Tentang Penulis</a>
          <button id="themeBtn" class="toggle" aria-label="Toggle theme"><i></i></button>
        </div>
      </div>
    </div>
  </header>

  <!-- Hero -->
  <section class="hero">
    <div class="wrap">
      <div class="hero-inner">
        <div class="avatar"></div>
        <div>
          <h1>Halo, aku Rafy Rayyan Ermadi</h1>
          <div class="desc">Blog progres menulis & belajar—novel tugas akhir, catatan proses, dan eksperimen tulisan.</div>
          <div class="meter"></div>
          <div id="statLine" class="stats">2 posting • 1 bab • 1 catatan</div>
        </div>
      </div>
    </div>
  </section>

  <!-- Toolbar -->
  <div class="wrap">
    <div class="toolbar">
      <div class="search">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M21 21l-3.8-3.8M10.8 18.5A7.7 7.7 0 1 1 10.8 3a7.7 7.7 0 0 1 0 15.4Z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
        <input id="q" placeholder="Cari judul, tag, atau seri..." />
      </div>
      <button id="sortBtn" class="chip">Terbaru</button>

      <div class="tag-wrap">
        <button id="tagBtn" class="chip">#Tag ▾</button>
        <div id="tagMenu" class="menu">
          <h5>FILTER #TAG</h5>
          <div data-tag="bab" class="item"># bab</div>
          <div data-tag="catatan" class="item"># catatan</div>
          <div data-tag="progres" class="item"># progres</div>
          <h5>LAINNYA</h5>
          <div data-tag="*" class="item">Tampilkan semua</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Main grid -->
  <main class="wrap">
    <div class="grid">
      <div id="list" class="fade"></div>

      <aside class="side">
        <div class="card">
          <h4>DAFTAR ISI</h4>
          <div id="toc" class="toc"></div>
        </div>
        <div class="card">
          <h4>Tentang Penulis</h4>
          <div style="display:flex;gap:14px;align-items:center">
            <div class="avatar" style="width:52px;height:52px;border-width:4px;box-shadow:0 0 0 4px var(--hero-ring)"></div>
            <div><strong>Rafy Rayyan Ermadi</strong><br/><span class="muted">Penulis</span></div>
          </div>
        </div>
      </aside>
    </div>
  </main>

  <!-- Footer -->
  <footer class="wrap">
    © 2025 • Made with ❤️ by <a href="https://www.instagram.com/rafy.rayyan/" target="_blank" rel="noopener">Rafy Rayyan</a>.
    Hak cipta dilindungi undang-undang. Mohon tidak menyalin atau mendistribusikan ulang tanpa izin.
  </footer>

  <!-- 4) App JS -->
  <script>
    // -----------------------
    // Data contoh (edit sesukamu)
    // -----------------------
    const POSTS = [
      {
        slug: "bab-1-bayang-kota",
        title: "Bab 1 — Bayang Kota",
        type: "bab",
        tags: ["bab","progres","novel"],
        date: "2025-09-01",
        minutes: 2,
        excerpt: "Pengenalan tokoh utama dan konflik awal.",
        html: `
          <p>Ini paragraf pembuka yang menyiapkan suasana kota saat senja. Lampu-lampu mulai hidup, dan bayangan gedung merayap di aspal basah.</p>
          <p>Tokoh utama berdiri di tepi trotoar, menatap persimpangan yang merubah nasibnya. Di situlah ia melihat tanda pertama—sebuah amplop ungu di bawah bangku halte.</p>
          <p>Dan begitulah bab dimulai.</p>
        `
      },
      {
        slug: "catatan-proses-1-kenapa-tema-ini",
        title: "Catatan Proses #1 — Kenapa Tema Ini?",
        type: "catatan",
        tags: ["catatan","progres"],
        date: "2025-08-30",
        minutes: 3,
        excerpt: "Menjawab pertanyaan: kenapa milih tema ini, dan apa riset awalnya.",
        html: `
          <p>Aku milih tema ini karena dekat dengan keseharian: kota kecil, suara malam, dan rahasia orang-orangnya. Riset awalku berupa foto jalanan dan wawancara singkat.</p>
          <p>Targetku: satu bab tiap pekan. Semoga konsisten!</p>
        `
      }
    ];

    // -----------------------
    // Utilities
    // -----------------------
    const $ = (sel, el=document) => el.querySelector(sel);
    const $$ = (sel, el=document) => [...el.querySelectorAll(sel)];

    const loader = $("#loader");
    function showLoader(){ loader.classList.add("show"); }
    function hideLoader(){ loader.classList.remove("show"); }

    function formatDate(d){
      const dt = new Date(d+"T00:00:00");
      return dt.toLocaleDateString("id-ID", { day:"2-digit", month:"short", year:"numeric"});
    }

    // Build TOC (Daftar isi = semua bab)
    function buildTOC(){
      const toc = $("#toc");
      const items = POSTS.filter(p=>p.type==="bab")
        .map(p=>`<a href="#/post/${p.slug}">${p.title}</a>`)
        .join("");
      toc.innerHTML = items || `<span class="muted">Belum ada bab.</span>`;
    }

    // Stats line
    function refreshStats(){
      const postCount = POSTS.length;
      const bab = POSTS.filter(p=>p.type==="bab").length;
      const catatan = POSTS.filter(p=>p.type==="catatan").length;
      $("#statLine").textContent = `${postCount} posting • ${bab} bab • ${catatan} catatan`;
    }

    // Card list
    function renderList({q="", tag="*", sort="desc"}={}){
      const wrap = $("#list");
      wrap.classList.remove("in");
      let data = [...POSTS];

      if(q){
        const qq = q.toLowerCase();
        data = data.filter(p =>
          p.title.toLowerCase().includes(qq) ||
          p.tags.join(" ").toLowerCase().includes(qq) ||
          (p.excerpt||"").toLowerCase().includes(qq)
        );
      }
      if(tag && tag!=="*"){
        data = data.filter(p => p.tags.includes(tag));
      }
      data.sort((a,b)=> sort==="desc"
        ? new Date(b.date)-new Date(a.date)
        : new Date(a.date)-new Date(b.date));

      wrap.innerHTML = data.map(p => `
        <article class="card">
          <div class="meta">${formatDate(p.date)} • ${p.minutes} menit baca</div>
          <a href="#/post/${p.slug}"><h3>${p.title}</h3></a>
          <p style="color:var(--text-soft);margin:10px 0 14px">${p.excerpt||""}</p>
          <div class="tags">
            ${p.tags.map(t=>`<span class="t"># ${t}</span>`).join("")}
          </div>
        </article>
      `).join("");

      requestAnimationFrame(()=>wrap.classList.add("in"));
    }

    // Post page
    function renderPost(slug){
      const post = POSTS.find(p=>p.slug===slug);
      const wrap = $("#list");
      wrap.classList.remove("in");

      if(!post){
        wrap.innerHTML = `<div class="card">Konten tidak ditemukan.</div>`;
        requestAnimationFrame(()=>wrap.classList.add("in"));
        return;
      }

      wrap.innerHTML = `
        <article class="card post">
          <div class="lead">${formatDate(post.date)} • ${post.minutes} menit baca</div>
          <h1>${post.title}</h1>
          <div class="tags" style="margin-bottom:8px">
            ${post.tags.map(t=>`<span class="t"># ${t}</span>`).join("")}
          </div>
          <div class="content">${post.html}</div>
        </article>
      `;
      requestAnimationFrame(()=>wrap.classList.add("in"));
    }

    // -----------------------
    // Router (hash-based)
    // -----------------------
    function route(){
      // Pastikan theme selalu diterapkan saat pindah halaman (fix “post jadi putih/pecah”)
      ensureTheme();

      showLoader();
      const hash = location.hash || "#/";
      const [_, path, param] = hash.split("/"); // ["#", "", "post", "slug"] -> path=""; param="post" (opsional)
      const page = (path||"").toLowerCase();

      // kecilkan menu tag jika terbuka
      $("#tagMenu").classList.remove("open");

      setTimeout(()=>{
        switch(page){
          case "": // beranda
          case "#":
            renderList(currentFilter);
            break;
          case "blog":
            renderList({...currentFilter, tag:"catatan"});
            break;
          case "novel":
            renderList({...currentFilter, tag:"bab"});
            break;
          case "about":
            $("#list").innerHTML = `
              <article class="card">
                <h3>Halo, aku Nama Kamu 👋</h3>
                <p class="content">Aku siswa kelas 12 yang lagi nulis novel untuk tugas akhir Bahasa Indonesia. Di blog ini, aku upload progres, bab, dan catatan proses kreatif.</p>
              </article>
            `;
            break;
          case "post":
            renderPost(param);
            break;
          default:
            $("#list").innerHTML = `<div class="card">Halaman tidak ditemukan.</div>`;
        }
        hideLoader();
      }, 220); // beri sedikit waktu utk animasi loader
    }

    window.addEventListener("hashchange", route);
    document.addEventListener("DOMContentLoaded", () => {
      buildTOC(); refreshStats(); route();
    });

    // -----------------------
    // Search & Tags & Sort
    // -----------------------
    const currentFilter = { q:"", tag:"*", sort:"desc" };

    $("#q").addEventListener("input", (e)=>{
      currentFilter.q = e.target.value.trim();
      if(location.hash.startsWith("#/post/")) location.hash="#/"; // balik ke list saat cari
      renderList(currentFilter);
    });

    $("#sortBtn").addEventListener("click", ()=>{
      currentFilter.sort = currentFilter.sort==="desc" ? "asc" : "desc";
      renderList(currentFilter);
    });

    const tagBtn = $("#tagBtn");
    const tagMenu = $("#tagMenu");
    tagBtn.addEventListener("click", ()=>{
      tagMenu.classList.toggle("open");
    });
    document.addEventListener("click", (e)=>{
      if(!tagMenu.contains(e.target) && !tagBtn.contains(e.target)){
        tagMenu.classList.remove("open");
      }
    });
    $$("#tagMenu .item").forEach(it=>{
      it.addEventListener("click", ()=>{
        const tg = it.getAttribute("data-tag");
        currentFilter.tag = tg;
        tagMenu.classList.remove("open");
        if(location.hash.startsWith("#/post/")) location.hash="#/";
        renderList(currentFilter);
      });
    });

    // -----------------------
    // Theme toggle (selalu terapkan lebih dahulu sebelum render)
    // -----------------------
    function ensureTheme(){
      const saved = localStorage.getItem("theme") || "dark";
      document.documentElement.setAttribute("data-theme", saved);
    }
    $("#themeBtn").addEventListener("click", ()=>{
      const cur = document.documentElement.getAttribute("data-theme");
      const next = cur==="dark" ? "light" : "dark";
      document.documentElement.setAttribute("data-theme", next);
      try{ localStorage.setItem("theme", next); }catch(e){}
    });
  </script>
</body>
</html>
