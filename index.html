<!doctype html>
<html lang="id" data-theme="dark">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Rafy • Blog</title>
  <meta name="color-scheme" content="dark light" />

  <!-- Set tema sedini mungkin agar bebas flicker/flash -->
  <script>
    (() => {
      try {
        const saved = localStorage.getItem("theme");
        const system = matchMedia("(prefers-color-scheme: dark)").matches ? "dark" : "light";
        document.documentElement.setAttribute("data-theme", saved || system);
        document.documentElement.classList.add("no-trans");
      } catch (_) {}
    })();
  </script>

  <style>
    /* ====== Palet mirip desain lama (dark elegan) ====== */
    :root{
      --bg: #0d1117;            /* dasar gelap */
      --surface: #0f1420;       /* panel */
      --fg: #e6edf3;            /* teks */
      --muted: #9aa7b6;         /* teks sekunder */
      --chip: #171b24;          /* chip/nav */
      --chip-bd: #263041;       /* garis chip */
      --stroke: rgba(255,255,255,.08);
      --primary: #8b7cff;       /* ungu lembut */
      --accent: #5bd4ff;        /* biru lembut */
      --radius: 16px;
      --shadow: 0 8px 24px rgba(0,0,0,.35);
    }
    [data-theme="light"]{
      --bg:#f7f8fb;
      --surface:#ffffff;
      --fg:#0f172a;
      --muted:#546179;
      --chip:#f3f5f8;
      --chip-bd:#e1e6ef;
      --stroke: rgba(0,0,0,.08);
      --shadow: 0 10px 24px rgba(20,32,60,.10);
    }

    /* Hilangkan transisi sampai siap */
    .no-trans *, .no-trans *::before, .no-trans *::after { transition: none !important; }

    /* ====== Base ====== */
    *{ box-sizing: border-box; }
    html,body{ height:100%; }
    body{
      margin:0; color:var(--fg); background:var(--bg);
      font: 16px/1.6 ui-sans-serif, system-ui, -apple-system, Inter, Segoe UI, Roboto, Helvetica, Arial;
      /* gradient hero halus seperti versi lama */
      background-image:
        radial-gradient(1200px 500px at 10% -10%, rgba(139,124,255,.22), transparent 60%),
        radial-gradient(1000px 500px at 90% -20%, rgba(91,212,255,.16), transparent 60%);
      background-attachment: fixed;
    }
    a{ color:inherit; text-decoration:none; }
    .wrap{ max-width:1100px; margin:0 auto; padding:20px; }

    /* ====== Navbar (chip bulat seperti sebelumnya) ====== */
    .nav{
      position:sticky; top:0; z-index:50;
      border-bottom: 1px solid var(--stroke);
      background: linear-gradient(to bottom, color-mix(in oklab,var(--bg),transparent 55%), transparent 100%);
      backdrop-filter: blur(8px) saturate(130%);
      -webkit-backdrop-filter: blur(8px) saturate(130%);
    }
    .nav .wrap{ display:flex; align-items:center; gap:12px; }
    .brand{ font-weight:800; font-size:22px; letter-spacing:.3px; }
    .spacer{ flex:1; }
    .chip{
      display:inline-flex; align-items:center; gap:8px;
      padding:10px 16px; border-radius:999px;
      background:var(--chip); border:1px solid var(--chip-bd); cursor:pointer;
      box-shadow: inset 0 0 0 1px color-mix(in oklab,var(--chip-bd),transparent 25%);
    }
    .chip:hover{ background: color-mix(in oklab, var(--chip), #ffffff 3%); }
    .icon{ width:18px; height:18px; border-radius:6px;
      background: conic-gradient(from 210deg, var(--primary), var(--accent)); }

    /* ====== Hero author-first (lebih mirip layout lama) ====== */
    .hero{ padding:46px 20px 18px; }
    .hero .wrap{ display:grid; grid-template-columns: 120px 1fr; gap:22px; align-items:center; }
    .avatar{
      width:120px; height:120px; border-radius:50%; display:grid; place-items:center;
      color:#fff; font-weight:900; text-align:center; line-height:1.15;
      background: radial-gradient(circle at 30% 30%, #d0c6ff, #9987ff);
      box-shadow: inset 0 0 0 6px rgba(255,255,255,.18), 0 15px 30px rgba(0,0,0,.35);
    }
    .hero-title{ margin:0; font-weight:900; line-height:1.08;
      font-size: clamp(28px, 5vw, 62px); letter-spacing:.2px; }
    .hero-sub{ margin:10px 0 0; color:var(--muted); font-size: clamp(14px, 2vw, 20px); }
    .meta{ margin-top:12px; color:var(--muted); font-size:14px; }

    /* ====== Controls (search + sort + tag) ====== */
    .controls{ display:flex; align-items:center; gap:10px; margin-top:18px; }
    .search{
      flex:1; display:flex; align-items:center; gap:10px;
      background:var(--surface); border:1px solid var(--stroke); border-radius:999px; padding:12px 16px;
      box-shadow: var(--shadow), inset 0 0 0 1px color-mix(in oklab,var(--stroke),transparent 40%);
      backdrop-filter: blur(4px);
    }
    .search input{ flex:1; border:none; outline:none; background:transparent; color:var(--fg); font:inherit; }
    .btn{ padding:10px 14px; border-radius:12px; background:var(--chip); border:1px solid var(--chip-bd); cursor:pointer; }
    .btn:hover{ background: color-mix(in oklab, var(--chip), #ffffff 3%); }

    .tag-wrap{ position:relative; }
    .tag-menu{
      position:absolute; right:0; top:calc(100% + 8px);
      width:260px; padding:12px; border-radius:14px;
      background:var(--surface); border:1px solid var(--stroke);
      box-shadow: var(--shadow);
      display:none; z-index:20;
    }
    .tag-menu.open{ display:block; }
    .tag-menu .sec{ font-size:12px; color:var(--muted); margin:4px 0 8px; }

    /* ====== Grid cards (mirip sebelumnya) ====== */
    .grid{ display:grid; grid-template-columns: repeat(2,minmax(0,1fr)); gap:18px; margin:20px 0 54px; }
    .card{
      border-radius:16px; overflow:hidden; background:var(--surface); border:1px solid var(--stroke);
      box-shadow: var(--shadow);
      backdrop-filter: blur(6px);
    }
    .card .thumb{ height:210px; background:linear-gradient(135deg, #8b7cff 0%, #5bd4ff 100%); opacity:.16; }
    .card .body{ padding:16px 16px 18px; }
    .title{ font-weight:800; font-size:20px; margin:6px 0 6px; }
    .muted{ color:var(--muted); font-size:14px; }
    .tags{ display:flex; gap:8px; flex-wrap:wrap; margin-top:10px; }
    .tag{ font-size:12px; padding:6px 10px; border-radius:999px; background:var(--chip); border:1px solid var(--chip-bd); }

    /* ====== Halaman post ====== */
    .post-layout{ display:grid; grid-template-columns: minmax(0,1fr) 300px; gap:18px; margin:20px 0 60px; }
    .prose{
      border-radius:16px; padding:22px; background:var(--surface); border:1px solid var(--stroke);
      box-shadow: var(--shadow);
    }
    .prose h1{ margin:4px 0 8px; font-size: clamp(22px, 3.2vw, 38px); }
    .prose p{ margin:12px 0; }
    .toc{
      position:sticky; top:90px;
      border-radius:14px; padding:16px; background:var(--surface); border:1px solid var(--stroke);
      box-shadow: var(--shadow);
    }
    .toc h4{ margin:0 0 8px; }
    .toc a{ display:block; padding:6px 0; color:var(--muted); }
    .toc a:hover{ color:var(--fg); }

    /* Fallback bila backdrop-filter tidak didukung (hindari putih/pecah) */
    @supports not ((backdrop-filter: blur(1px)) or (-webkit-backdrop-filter: blur(1px))) {
      .search, .card, .prose, .toc, .btn { background: color-mix(in oklab, var(--bg), #ffffff 3%); }
      [data-theme="light"] .search, [data-theme="light"] .card, [data-theme="light"] .prose, [data-theme="light"] .toc, [data-theme="light"] .btn { background:#fff; }
    }

    /* ====== Footer ====== */
    footer{ border-top:1px solid var(--stroke); }
    footer .wrap{ display:flex; justify-content:center; align-items:center; padding:18px; color:var(--muted); gap:6px; }
    footer a{ text-decoration: underline; text-decoration-color: color-mix(in oklab, var(--muted), transparent 30%); }

    /* ====== Preloader (tetap halus) ====== */
    .pre{
      position:fixed; inset:0; display:grid; place-items:center; z-index:9999;
      pointer-events:none; opacity:0; transition:opacity .35s ease;
      background: radial-gradient(900px 400px at 20% -10%, rgba(139,124,255,.10), transparent 60%),
                  radial-gradient(900px 400px at 80% -20%, rgba(91,212,255,.10), transparent 60%),
                  var(--bg);
    }
    .pre.show{ opacity:1; pointer-events:auto; }
    .spin{
      width:56px; height:56px; border-radius:50%;
      background:
        conic-gradient(from 0deg, color-mix(in oklab, var(--primary), transparent 25%), transparent 60%),
        conic-gradient(from 180deg, color-mix(in oklab, var(--accent), transparent 25%), transparent 60%);
      mask: radial-gradient(circle at center, transparent 46%, #000 47%);
      animation: spin 1.1s linear infinite;
    }
    @keyframes spin{ to{ transform: rotate(1turn); } }
    @media (prefers-reduced-motion: reduce){
      .spin{ animation: none; }
      .pre{ transition:none; }
    }

    /* ====== Responsive ====== */
    @media (max-width: 900px){
      .grid{ grid-template-columns:1fr; }
      .post-layout{ grid-template-columns:1fr; }
      .toc{ position:relative; top:auto; }
      .hero .wrap{ grid-template-columns: 84px 1fr; gap:16px; }
      .avatar{ width:84px; height:84px; font-size:12px; }
    }
  </style>
</head>
<body>
  <!-- Preloader -->
  <div class="pre" id="pre"><div class="spin"></div></div>

  <!-- Navbar -->
  <div class="nav">
    <div class="wrap">
      <div class="brand">Rafy • Blog</div>
      <div class="spacer"></div>
      <a href="#/" class="chip">Beranda</a>
      <a href="#/blog" class="chip">Blog</a>
      <a href="#/novel" class="chip">Novel</a>
      <a href="#/about" class="chip">Tentang Penulis</a>
      <button id="themeBtn" class="chip" title="Dark / Light"><span class="icon"></span></button>
    </div>
  </div>

  <!-- Hero -->
  <header class="hero">
    <div class="wrap">
      <div class="avatar">Rafy<br>Rayyan<br>Ermadi</div>
      <div>
        <h1 class="hero-title">Halo, aku Rafy Rayyan Ermadi</h1>
        <p class="hero-sub">Blog progres menulis & belajar—novel tugas akhir, catatan proses, dan eksperimen tulisan.</p>
        <div class="meta"><span id="metaCount">0 posting • 0 bab • 0 catatan</span></div>
      </div>
    </div>
  </header>

  <!-- Controls -->
  <div class="wrap">
    <div class="controls">
      <label class="search">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><circle cx="11" cy="11" r="7" stroke="currentColor" opacity=".5" stroke-width="2"/><path d="M20 20L17 17" stroke="currentColor" opacity=".5" stroke-width="2" stroke-linecap="round"/></svg>
        <input id="q" placeholder="Cari judul, tag, atau seri…" />
      </label>
      <button class="btn" id="sortBtn">Terbaru</button>
      <div class="tag-wrap">
        <button class="btn" id="tagBtn">#Tag ▾</button>
        <div class="tag-menu" id="tagMenu">
          <div class="sec">FILTER #TAG</div>
          <div id="tagList"></div>
          <div class="sec">LAINNYA</div>
          <a href="#" id="showAll" class="btn" style="display:inline-flex;padding:8px 10px;margin-top:6px;">Tampilkan semua</a>
        </div>
      </div>
    </div>

    <!-- View mount -->
    <div id="view"></div>
  </div>

  <!-- Footer -->
  <footer>
    <div class="wrap">
      © 2025 • Made with ❤️ by
      <a href="https://www.instagram.com/rafy.rayyan/" target="_blank" rel="noopener">Rafy Rayyan</a>.
      Hak cipta dilindungi undang-undang. Mohon tidak menyalin atau mendistribusikan ulang tanpa izin.
    </div>
  </footer>

  <script>
    // Lepas blok transisi setelah konten siap
    window.addEventListener("DOMContentLoaded", () => {
      document.documentElement.classList.remove("no-trans");
    });

    /* ====== Data sample (ganti dengan punyamu) ====== */
    const POSTS = [
      {
        slug:"bab-1-bayang-kota",
        title:"Bab 1 — Bayang Kota",
        date:"2025-09-01",
        tags:["bab","progres","novel"],
        excerpt:"Pengenalan tokoh utama dan konflik awal.",
        body:`<p>Ini paragraf pembuka yang menyiapkan suasana kota saat senja. Lampu-lampu mulai hidup, dan bayangan gedung merayap di aspal basah.</p>
        <p>Tokoh utama berdiri di tepi trotoar, menatap persimpangan yang mengubah nasibnya. Di sinilah cerita berangkat.</p>`
      },
      {
        slug:"catatan-proses-1",
        title:"Catatan Proses #1 — Kenapa Tema Ini?",
        date:"2025-08-30",
        tags:["progres","catatan"],
        excerpt:"Kenapa milih tema ini, dan apa riset awalnya.",
        body:`<p>Catatan proses tentang pemilihan tema, riset kecil-kecilan, dan eksperimen gaya bahasa.</p>`
      }
    ];

    /* ====== State ====== */
    let currentSort = "newest";
    let activeTag = null;

    /* ====== Helpers ====== */
    const qs = (s, el=document) => el.querySelector(s);
    const qsa = (s, el=document) => [...el.querySelectorAll(s)];
    const pre = qs("#pre");
    const showPre = () => pre.classList.add("show");
    const hidePre = () => setTimeout(()=> pre.classList.remove("show"), 220);

    /* ====== Theme toggle ====== */
    qs("#themeBtn").addEventListener("click", ()=>{
      const cur = document.documentElement.getAttribute("data-theme") || "dark";
      const next = cur === "dark" ? "light" : "dark";
      document.documentElement.setAttribute("data-theme", next);
      localStorage.setItem("theme", next);
    });

    /* ====== Tag dropdown (ikut scroll, anchor ke tombol) ====== */
    const tagBtn = qs("#tagBtn"), tagMenu = qs("#tagMenu");
    tagBtn.addEventListener("click", (e)=>{ e.stopPropagation(); tagMenu.classList.toggle("open"); });
    document.addEventListener("click", (e)=>{ if (!tagMenu.contains(e.target) && !tagBtn.contains(e.target)) tagMenu.classList.remove("open"); });

    /* ====== Build Tag List ====== */
    function buildTags(){
      const map = new Map();
      POSTS.forEach(p => p.tags.forEach(t => map.set(t, (map.get(t)||0) + 1)));
      const wrap = qs("#tagList"); wrap.innerHTML = "";
      [...map.keys()].sort().forEach(t=>{
        const b = document.createElement("button");
        b.className="btn"; b.style.margin="4px 6px 0 0"; b.textContent=`# ${t} (${map.get(t)})`;
        b.onclick = ()=>{ activeTag = t; tagMenu.classList.remove("open"); render(); };
        wrap.appendChild(b);
      });
      qs("#showAll").onclick = (e)=>{ e.preventDefault(); activeTag=null; render(); };
    }

    /* ====== Search & Sort ====== */
    qs("#q").addEventListener("input", render);
    qs("#sortBtn").addEventListener("click", ()=>{
      currentSort = currentSort === "newest" ? "oldest" : "newest"; render();
    });

    /* ====== Router ====== */
    const view = qs("#view");
    const routes = { "/": renderHome, "/blog": renderHome, "/novel": renderHome, "/about": renderAbout };
    const getPath = () => (location.hash || "#/").replace(/^#/, "");
    window.addEventListener("hashchange", ()=>{ showPre(); setTimeout(render, 40); });

    /* ====== Renderers ====== */
    function render(){
      const path = getPath();
      const total = POSTS.length;
      const bab = POSTS.filter(p=>p.tags.includes("bab")).length;
      const cat = POSTS.filter(p=>p.tags.includes("catatan")).length;
      qs("#metaCount").textContent = `${total} posting • ${bab} bab • ${cat} catatan`;

      if (path.startsWith("/post/")){ renderPost(path.replace("/post/","")); hidePre(); return; }
      (routes[path] || renderHome)(); hidePre();
    }

    function renderHome(){
      const term = qs("#q").value.trim().toLowerCase();
      let list = POSTS.slice();
      if (activeTag) list = list.filter(p=> p.tags.includes(activeTag));
      if (term) list = list.filter(p => (p.title + " " + p.excerpt + " " + p.tags.join(" ")).toLowerCase().includes(term));
      list.sort((a,b)=> currentSort==="newest" ? b.date.localeCompare(a.date) : a.date.localeCompare(b.date));

      view.innerHTML = `
        <div class="grid">
          ${list.map(p => `
            <article class="card" data-slug="${p.slug}">
              <div class="thumb"></div>
              <div class="body">
                <div class="muted">${new Date(p.date).toLocaleDateString("id-ID",{day:"2-digit",month:"short",year:"numeric"})}</div>
                <div class="title">${p.title}</div>
                <div class="muted">${p.excerpt}</div>
                <div class="tags">${p.tags.map(t=>`<span class="tag"># ${t}</span>`).join("")}</div>
              </div>
            </article>`).join("")}
        </div>`;
      buildTags();
      qsa(".card").forEach(c => c.addEventListener("click", ()=> location.hash = "#/post/" + c.dataset.slug));
    }

    function renderPost(slug){
      const p = POSTS.find(x=>x.slug===slug);
      if (!p){ view.innerHTML = `<p>Tulisan tidak ditemukan.</p>`; return; }
      const d = new Date(p.date).toLocaleDateString("id-ID",{day:"2-digit",month:"long",year:"numeric"});
      view.innerHTML = `
        <div class="post-layout">
          <article class="prose">
            <h1>${p.title}</h1>
            <div class="muted">${d} • ${p.tags.map(t=>`#${t}`).join("  •  ")}</div>
            ${p.body}
          </article>
          <aside class="toc">
            <h4>DAFTAR ISI</h4>
            <a href="#/post/${slug}">${p.title}</a>
            <div class="sec" style="margin-top:10px;font-size:12px;color:var(--muted)">Tentang</div>
            <a href="#/about">Tentang Penulis</a>
          </aside>
        </div>`;
      setTimeout(hidePre, 140);
    }

    function renderAbout(){
      view.innerHTML = `
        <article class="prose">
          <h1>Halo, aku Nama Kamu 👋</h1>
          <p>Aku siswa kelas 12 yang lagi nulis novel untuk tugas akhir Bahasa Indonesia. Di blog ini, aku upload progres, bab, dan catatan proses kreatif.</p>
          <p>Kritik & saran sangat membantu! 🙏</p>
        </article>`;
    }

    // Boot
    buildTags();
    showPre();
    window.addEventListener("load", ()=>{ render(); hidePre(); });
  </script>
</body>
</html>
